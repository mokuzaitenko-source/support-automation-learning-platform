{% extends "base.html" %}

{% block title %}{{ lesson.title }} - Python Learning Platform{% endblock %}

{% block content %}
<div class="lesson-container">
    <div class="container">
        <div class="lesson-header-section">
            <a href="/" class="back-link"><i class="fas fa-arrow-left"></i> Back to Lessons</a>
            <h1 class="lesson-main-title">{{ lesson.title }}</h1>
            <p class="lesson-main-description">{{ lesson.description }}</p>
        </div>

        <div class="lesson-content">
            <div class="topics-sidebar">
                <h3><i class="fas fa-list"></i> Topics</h3>
                <ul class="topics-list">
                    {% for topic in lesson.topics %}
                    <li class="topic-item {% if loop.first %}active{% endif %}" data-topic-index="{{ loop.index0 }}">
                        <i class="fas fa-circle topic-dot"></i>
                        <span>{{ topic.name }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <div class="topic-content">
                {% for topic in lesson.topics %}
                <div class="topic-panel {% if loop.first %}active{% endif %}" data-topic-index="{{ loop.index0 }}">
                    <h2 class="topic-title">{{ topic.name }}</h2>
                    
                    <div class="editor-section">
                        <div class="editor-header">
                            <span><i class="fas fa-code"></i> Code Editor</span>
                            <button class="btn btn-run" data-topic-index="{{ loop.index0 }}" onclick="runCode(this.dataset.topicIndex)">
                                <i class="fas fa-play"></i> Run Code
                            </button>
                        </div>
                        <textarea id="code-editor-{{ loop.index0 }}" class="code-editor">{{ topic.code }}</textarea>
                    </div>

                    <div class="output-section">
                        <div class="output-header">
                            <i class="fas fa-terminal"></i> Output
                        </div>
                        <pre id="output-{{ loop.index0 }}" class="output-box">Click "Run Code" to see the output...</pre>
                    </div>

                    <div class="navigation-buttons">
                        {% if not loop.first %}
                        <button class="btn btn-secondary" data-topic-index="{{ loop.index0 - 1 }}" onclick="navigateTopic(this.dataset.topicIndex)">
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        {% endif %}
                        {% if not loop.last %}
                        <button class="btn btn-primary ml-auto" data-topic-index="{{ loop.index0 + 1 }}" onclick="navigateTopic(this.dataset.topicIndex)">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                        {% else %}
                        <a href="/" class="btn btn-success ml-auto">
                            <i class="fas fa-check"></i> Complete Lesson
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/lesson.js') }}"></script>
{% endblock %}
